services:
  # 這是我們的 Node.js 後端服務
  - type: web
    name: daigo-backend-service
    env: node
    plan: free
    buildCommand: "npm install"
    startCommand: "npm start"
    envVars:
      - key: NODE_VERSION
        value: 20
      - key: PORT
        value: 5000
      # --- SendGrid 密鑰 ---
      - key: SENDGRID_API_KEY
        fromSecret: true
      - key: SENDGRID_SENDER_EMAIL
        fromSecret: true
      - key: SENDGRID_ADMIN_EMAIL
        fromSecret: true
      - key: ADMIN_SECRET_KEY
        fromSecret: true
      - key: SITE_NAME
        value: "XX 代購平台"
      # --- 資料庫連線 ---
      # 關鍵！這會自動使用 "Internal Database URL"
      - key: DATABASE_URL
        from:
          database:
            name: daigo1688-db
            property: connectionString

# 這是我們的資料庫 (它只是一個 "宣告"，實際建立是在步驟一)
databases:
  - name: daigo1688-db
    plan: free
